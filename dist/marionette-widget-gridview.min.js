Backbone.Widget=Backbone.Model.extend({defaults:{type:"default",viewType:Marionette.WidgetView,name:"noname",x:0,y:0,width:0,height:0,id:0}}),Backbone.WidgetList=Backbone.Collection.extend({model:Backbone.Widget}),Marionette.WidgetView=Marionette.ItemView.extend({template:_.template("<p>Default WidgetView</p>"),somefunction:function(){console.log("some function called")}}),Marionette.WidgetGridView=Marionette.LayoutView.extend({firstRender:!0,template:"#gridview-template",collectionEvents:{},initialize:function(a){a=a||{},console.log("init called"),a.collectionType&&a.collection?(this.collectionType=a.collectionType,this.collection=a.collection,console.log(this.collection)):console.log("created a GridView without any collection information")},onRender:function(){this.initializeGridstack(),this.showWidgets(),console.log("asdhasdashdhasdkahk")},initializeGridstack:function(a){a=a||{},$(".grid-stack").gridstack(a),this.collection.models&&this.populateGridstackWidgets()},populateGridstackWidgets:function(){var a=$(".grid-stack").data("gridstack"),b=this;_.each(this.collection.models,function(c){var d=c.get("name")+c.get("id"),e={x:0,y:0,width:c.get("width"),height:c.get("height"),el:'<div class="grid-stack-item"><div class="grid-stack-item-content"><p class="x-icon">X</p><div id="'+d+'" class="widget-content"></div></div></div>'};b.addGridstackWidget(a,e)&&b.addRegion(d,"#"+d)})},addGridstackWidget:function(a,b){return console.log("adding widget"),a.will_it_fit(b.x,b.y,b.width,b.height,!0)?(a.add_widget(b.el,b.x,b.y,b.width,b.height,!0),!0):(console.log("Not enough free space to place the widget"),!1)},showWidgets:function(){var a=this;this.collection.models&&_.each(this.collection.models,function(b){var c=b.get("name")+b.get("id");a.getRegion(c).show(new(b.get("viewType")))})}});